!function(){let e=null;const t=e=>{console.log(`[BackgroundSerializerWorker] ${e}`)};self.onmessage=async i=>{const{type:r,binary:s,requestId:n,versionWithHash:a}=i.data||{},o=Date.now();if(t(`Request #${n} received (${r}).`),"SERIALIZE_TO_JSON"===r||"SERIALIZE_TO_JS_OBJECT"===r)try{const i=await(t=>e||(e=new Promise(((e,i)=>{try{const r=`/libGD.js?cache-buster=${t}`;if(importScripts(r),"function"!==typeof initializeGDevelopJs)return void i(new Error("Missing initializeGDevelopJs in worker"));initializeGDevelopJs({locateFile:(e,i)=>e+`?cache-buster=${t}`}).then((t=>{e(t)})).catch(i)}catch(r){return void i(r)}})),e))(a),l=((e,t)=>{const i=t instanceof Uint8Array?t:new Uint8Array(t),r=i.byteLength||i.length,s=e._malloc(r);e.HEAPU8.set(i,s);const n=e.BinarySerializer.deserializeBinarySnapshot(s,r);if(e._free(s),0===n.ptr)throw new Error("Failed to deserialize binary snapshot.");const a=e.Serializer.toJSON(n);return n.delete(),a})(i,s),c="SERIALIZE_TO_JSON"===r?l:JSON.parse(l);t(`Request #${n} done in ${Date.now()-o}ms.`),self.postMessage({type:"DONE",result:c,requestId:n,duration:Date.now()-o})}catch(l){self.postMessage({type:"ERROR",requestId:n,message:l.message})}}}();
//# sourceMappingURL=BackgroundSerializer.worker.f8c037d0aa64c085d630.worker.js.map